<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Plugins (Interceptors) | Magento 2 Developer Documentation</title>
	<meta name="description" content="Magento 2 Developer Documentation.
">

	<link rel="stylesheet" href="/assets/css/app.css" />
	<link rel="stylesheet" href="/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/common/css/devdocs.css" />
<link rel="alternate" type="application/rss+xml" title="Magento DevDocs RSS" href="/feed.xml" />

	<script>
  var baseUrl = "";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c"
  };
</script>



<!-- Google Analytics -->
<style>.async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{'GTM-ML6GZCH':true});</script>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-66243208-1', 'auto');
    ga('require', 'GTM-ML6GZCH');
    ga('send', 'pageview');
</script>

<!-- Hotjar Tracking Code for http://devdocs.magento.com/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:806243,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

<!-- heap analytics -->
<script type="text/javascript">
      window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
      heap.load("2619540280");
</script>

<script src="//assets.adobedtm.com/98fab992275ef6366cc65f57f86b1e895a66c912/satelliteLib-f90f1129109ea4b2101512675a2769865aa7ea5b.js"></script>




	<link rel="canonical" href="https://devdocs.magento.com/guides/v2.3/extension-dev-guide/plugins.html">

	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <button id="menu-btn" class="menu-trigger menu-icon" aria-haspopup="true" aria-controls="nav-main"></button>
  </div>

  <div class="nav-container">

    <a class="logo" href="/guides/v2.3/">
      <img src="/assets/i/m-logo.svg" alt=""><img src="/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      
<div class="version-switcher dropdown" data-version="2.3">
	<button id="version-switcher-button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Magento 2.3 Alpha
	</button>

	<ul class="dropdown-menu dropdown-menu-left" aria-labelledby="version-switcher-button">
		
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.0/extension-dev-guide/plugins.html">Magento 2.0</a></li>
		
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.1/extension-dev-guide/plugins.html">Magento 2.1</a></li>
		
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.2/extension-dev-guide/plugins.html">Magento 2.2</a></li>
		
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.3/extension-dev-guide/plugins.html">Magento 2.3 Alpha</a></li>
		
  </ul>
</div>


      <!-- Main Navigation -->


<ul class="nav-main" role="menubar">




  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Cloud</span>

    
      <div class="nav-popup" role="menu" aria-hidden="true">

      

      
        <ul>
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/cloud/bk-cloud.html">Cloud Guide</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/cloud/architecture/cloud-architecture.html">Cloud Architecture</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/cloud/env/environments.html">Configure Environments</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/cloud/project/project-upgrade-parent.html">Upgrades and Patches</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/cloud/release-notes/cloud-tools.html">ece-tools Release Notes</a>
  </li>



          
        
      </ul>
      

      </div>
    

  </li>
  




  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Setup</span>

    
      <div class="nav-popup" role="menu" aria-hidden="true">

      

      
        <ul>
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/install-gde/bk-install-guide.html">Installation Guide</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/comp-mgr/bk-compman-upgrade-guide.html">Extension Update and System Upgrade Guide</a>
  </li>



          
        
          
          
            







          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/config-guide/bk-config-guide.html">Configuration Guide</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/performance-best-practices/">Performance Best Practices</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/migration/bk-migration-guide.html">Migration Guide</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/cloud/bk-cloud.html">Magento Commerce (Cloud) Guide</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/magento-release-information.html">Release Information</a>
  </li>



          
        
      </ul>
      

      </div>
    

  </li>
  




  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Development</span>

    
      <div class="nav-popup" role="menu" aria-hidden="true">

      

      
        
        
          
          
            <div class="nav-section">
              <div class="nav-section-title">Backend</div>
              <ul>
              
                





  
  
  
  <li>
    <a href="/guides/v2.3/architecture/bk-architecture.html">Architecture</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/extension-dev-guide/bk-extension-dev-guide.html">PHP Developer Guide</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/ext-best-practices/bk-ext-best-practices.html">Extension Developer Best Practices</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/mrg/intro.html">Module Reference Guide</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/coding-standards/bk-coding-standards.html">Coding Standards</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/contributor-guide/contributing.html">Contributor Guide</a>
  </li>



              
              </ul>
            </div>
          
        
          
          
            <div class="nav-section">
              <div class="nav-section-title">Frontend</div>
              <ul>
              
                





  
  
  
  <li>
    <a href="/guides/v2.3/frontend-dev-guide/bk-frontend-dev-guide.html">Frontend Developer Guide</a>
  </li>



              
                







              
                





  
  
  
  <li>
    <a href="/guides/v2.3/ui_comp_guide/bk-ui_comps.html">UI Components Guide</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript Developer Guide</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/pattern-library/bk-pattern.html">Admin Design Pattern Library</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/design-styleguide/bk-styleguide.html">Admin Style Guide</a>
  </li>



              
                





  
  
  
  <li>
    <a href="https://magento-research.github.io/pwa-studio/">Magento PWA Documentation Site</a>
  </li>



              
              </ul>
            </div>
          
        
          
          
            <div class="nav-section">
              <div class="nav-section-title">API</div>
              <ul>
              
                





  
  
  
  <li>
    <a href="/guides/v2.3/get-started/bk-get-started-api.html">Get Started with Magento Web APIs</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/rest/bk-rest.html">REST API Reference</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/soap/bk-soap.html">SOAP API Reference</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/graphql/">GraphQL Developer Guide</a>
  </li>



              
                





  
  
  
  <li>
    <a href="/guides/v2.3/marketplace/eqp/api.html">Marketplace EQP API Reference</a>
  </li>



              
                





  
  
  
  <li>
    <a href="https://developers.rjmetrics.com/">Magento BI Import REST API</a>
  </li>



              
              </ul>
            </div>
          
        
      
      

      </div>
    

  </li>
  




  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Testing</span>

    
      <div class="nav-popup" role="menu" aria-hidden="true">

      

      
        <ul>
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/test/testing.html">Magento Testing Guide</a>
  </li>



          
        
          
          
            







          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/magento-functional-testing-framework/2.3/introduction.html">Functional Acceptance Testing</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/mtf/mtf_introduction.html">Functional Testing</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/test/integration/integration_test_execution.html">Integration Testing</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/test/js/jasmine.html">JavaScript Unit Testing</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/test/unit/unit_test_execution.html">PHP Unit Testing</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/get-started/web-api-functional-testing.html">Web API Functional Testing</a>
  </li>



          
        
      </ul>
      

      </div>
    

  </li>
  




  
  <li class="nav-main-separator"></li>
  




  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Functional Areas</span>

    
      <div class="nav-popup" role="menu" aria-hidden="true">

      

      
        <ul>
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/advanced-reporting/overview.html">Advanced Reporting</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/b2b/bk-b2b.html">B2B</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/howdoi/checkout/checkout_overview.html">Checkout</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="http://omsdocs.magento.com/en/">Order Management</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/payments-integrations/bk-payments-integrations.html">Payment Integrations</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/extension-dev-guide/staging.html">Staging</a>
  </li>



          
        
      </ul>
      

      </div>
    

  </li>
  




  
  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">Tutorials</span>

    
      <div class="nav-popup" role="menu" aria-hidden="true">

      

      
        <ul>
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/rest/tutorials/index.html">Rest Tutorials</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/howdoi/customize_product.html">Customize Product Creation Form</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/guides/v2.3/howdoi/checkout/checkout_overview.html">Customize Checkout</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/community/resources/support.html">Magento Support</a>
  </li>



          
        
          
          
            





  
  
  
  <li>
    <a href="/videos/">Video Tutorials</a>
  </li>



          
        
      </ul>
      

      </div>
    

  </li>
  



</ul><!-- /.nav-main -->
    </div>

    <div class="search-btn">
      <button class="search-trigger search-icon"></button>
    </div>

    <form class="quick-search" action="/guides/v2.3/search.html" method="get" novalidate="novalidate">
      <input type="search" name="q" placeholder="Search" />
      <button class="quick-search-close">&times;</button>
    </form>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		


<div class="message-banner">
    This is the 2.3 Alpha release version of Magento documentation. Content in this version is subject to change.
</div>



		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<a href="#" data-proofer-ignore class="toc-toggler">Table of Contents</a>
	<div class="sidebar-wrapper">

		
		
		<h4 class="guide-title">PHP Developer Guide</h4>
		<div class="collapsible-navigation">
		    <ul>
		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/bk-extension-dev-guide.html">Introduction</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/intro/developers_roadmap.html">Developer roadmap</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/intro/intro-composer.html">Introduction to Composer</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/intro/intro-composer-gloss.html">Glossary of common terms</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/prepare/prepare.html">Prepare (development quick start)</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/prepare/dev-modtypes.html">Component types</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/prepare/prepare_file-str.html">About component file structure</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/prepare/ext-repo-structure.html">Extension repository structure</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/prepare/dev-summary.html">Roadmap for developing and packaging components</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/prepare/lifecycle.html">Extension lifecycle</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/build.html">Build</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/di-xml-file.html">The di.xml file</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/optimal-dev-environment.html">Optimal development environment</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/composer-integration.html">The composer.json file</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/required-configuration-files.html">Define your configuration files</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/module-file-structure.html">Create your component file structure</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/component-registration.html">Register your component</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/XSD-XML-validation.html">URN schema validation</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/create_component.html">Name your component</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/module-load-order.html">Component load order</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/build/enable-module.html">Enable or disable your component</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/package/package.html">Package</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/package/package_module.html">Package a component</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/package/package_mktpl.html">Upload your component to the Magento Marketplace</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/validate/validate.html">Validate</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/validate/test-module.html">Test your component</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cache/partial-caching.html">Partial caching</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cache/partial-caching/database-caching.html">Create custom cache engines</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cache/partial-caching/create-cache-type.html">Create a cache type</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cache/page-caching.html">Full page caching</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cache/page-caching/public-content.html">Public content</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cache/page-caching/private-content.html">Private content</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cli-cmds/cli-add.html">Add CLI commands</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cli-cmds/cli-naming-guidelines.html">Command naming guidelines</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/cli-cmds/cli-howto.html">How to add CLI commands</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/staging.html">Staging (Magento Commerce only)</a>
  

  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/module-development.html">Component development</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/service-contracts/service-contracts.html">Service contracts</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/api-concepts.html">Public interfaces &amp; APIs</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/service-contracts/design-patterns.html">Service contract design patterns</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/depend-inj.html">Dependency injection</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/object-manager.html">ObjectManager</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/events-and-observers.html">Events and observers</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/factories.html">Factories</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/proxies.html">Proxies</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/code-generation.html">Code generation</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/attributes.html">EAV and extension attributes</a>
  

  
</li>



      
         





  
  
  

  
  
<li class="active ">
  
    <a href="/guides/v2.3/extension-dev-guide/plugins.html">Plugins (Interceptors)</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/routing.html">Routing</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <span>Indexing</span>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/indexing.html">Indexing overview</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/indexer-batch.html">Indexer optimization</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/indexing-custom.html">Adding a custom indexer</a>
  

  
</li>



      
    </ul>
  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <span>Declarative schema</span>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/declarative-schema/">Declarative schema overview</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/declarative-schema/migration-commands.html">Migrate install/upgrade scripts to declarative schema</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/declarative-schema/db-schema.html">Configure declarative schema</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/declarative-schema/data-patches.html">Develop data and schema patches</a>
  

  
</li>



      
    </ul>
  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <span>Web APIs</span>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/service-contracts/service-to-web-service.html">Configure services as web APIs</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/webapi/custom-routes.html">Set custom routes</a>
  

  
</li>



      
    </ul>
  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <span>Message Queues</span>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/message-queues/message-queues.html">Message queues overview</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/message-queues/config-mq.html">Configure message Queues</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/message-queues/queue-migration.html">Migrate message queue configuration</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/message-queues/bulk-operations.html">Bulk operations</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/message-queues/implement-bulk.html">Example bulk operations implementation</a>
  

  
</li>



      
    </ul>
  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/extension_attributes/adding-attributes.html">Adding extension attributes to entity</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/searching-with-repositories.html">Searching with repositories</a>
  

  
</li>



      
         







      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/howdoi/php/php_clear-dirs.html">Clear directories during development</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/adapters.html">Adapters</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/variable-pool/">Variable Pool</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <span>Configuration</span>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/configuration/sensitive-and-environment-settings.html">Sensitive Environment Settings</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/configuration/importers.html">Configuration Importers</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <span>Framework</span>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/framework/serializer.html">Serialize Library</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <span>Security</span>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/xss-protection.html">XSS Prevention</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/security/non-secure-functions.html">Non-secure functions</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    	





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/versioning/">Versioning</a>
  

  
    <ul>
      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/versioning/dependencies.html">Module version dependencies</a>
  

  
</li>



      
         





  
  
  

  
  
<li class=" ">
  
    <a href="/guides/v2.3/extension-dev-guide/versioning/codebase-changes.html">Codebase changes</a>
  

  
</li>



      
    </ul>
  
</li>



		    
		    </ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->

	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

	

	

	<h1 class="page-heading">Plugins (Interceptors)</h1>

  


</section>

			<h3 id="overview">Overview</h3>

<p>A plugin, or interceptor, is a class that modifies the behavior of public class functions by intercepting a function call and running code before, after, or around that function call. This allows you to <em>substitute</em> or <em>extend</em> the behavior of original, public methods for any <em>class</em> or <em>interface</em>.</p>

<p>Extensions that wish to intercept and change the behavior of a <em>public method</em> can create a <code class="highlighter-rouge">Plugin</code> class.</p>

<p>This   <span term-uuid="deea5a5a-e9e5-4591-b141-b849458feb1a" class="glossary-term" data-toggle="popover">interception</span>
 approach reduces conflicts among extensions that change the behavior of the same class or method. Your <code class="highlighter-rouge">Plugin</code> class implementation changes the behavior of a class function, but it does not change the class itself. Magento calls these interceptors sequentially according to a configured sort order, so they do not conflict with one another.</p>

<h4 id="limitations">Limitations</h4>

<p>Plugins can not be used on following:</p>

<ul>
  <li>Final methods</li>
  <li>Final classes</li>
  <li>Non-public methods</li>
  <li>Class methods (such as static methods)</li>
  <li><code class="highlighter-rouge">__construct</code></li>
  <li>Virtual types</li>
  <li>Objects that are instantiated before <code class="highlighter-rouge">Magento\Framework\Interception</code> is bootstrapped</li>
</ul>

<h3 id="declaring-a-plugin">Declaring a plugin</h3>

<p>The <code>di.xml</code> file in your   <span term-uuid="c1e4242b-1f1a-44c3-9d72-1d5b1435e142" class="glossary-term" data-toggle="popover">module</span>
 declares a plugin for a class object:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"> 
<span class="nt">&lt;config&gt;</span>
    <span class="nt">&lt;type</span> <span class="na">name=</span><span class="s">"{ObservedType}"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;plugin</span> <span class="na">name=</span><span class="s">"{pluginName}"</span> <span class="na">type=</span><span class="s">"{PluginClassName}"</span> <span class="na">sortOrder=</span><span class="s">"1"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/type&gt;</span>
<span class="nt">&lt;/config&gt;</span></code></pre></figure>

<p>You must specify these elements:</p>

<ul>
  <li><code class="highlighter-rouge">type name</code>. A class or interface which the plugin observes.</li>
  <li><code class="highlighter-rouge">plugin name</code>. An arbitrary plugin name that identifies a plugin. Also used to merge the configurations for the plugin.</li>
  <li><code class="highlighter-rouge">plugin type</code>. The name of a plugin’s class or its virtual type. Use the following naming convention when you specify this element: <code class="highlighter-rouge">\Vendor\Module\Plugin\&lt;ClassName&gt;</code>.</li>
</ul>

<p>The following elements are optional:</p>

<ul>
  <li><code class="highlighter-rouge">plugin sortOrder</code>. Plugins that call the same method run them using this order.</li>
  <li><code class="highlighter-rouge">plugin disabled</code>. To disable a plugin, set this element to <code class="highlighter-rouge">true</code>. The default value is <code class="highlighter-rouge">false</code>.</li>
</ul>

<h3 id="defining-a-plugin">Defining a plugin</h3>

<p>By applying code before, after, or around a public method, a plugin extends or modifies that method’s behavior.</p>

<p>The first argument for the before, after, and around methods is an object that provides access to all public methods of the observed method’s class.</p>

<h4 id="before-methods">Before methods</h4>

<p>Magento runs all before methods ahead of the call to an observed method. These methods must have the same name as the observed method with ‘before’ as the prefix.</p>

<p>You can use before methods to change the arguments of an observed method by returning a modified argument. If there is more than one argument, the method should return an array of those arguments. If the method does not change the argument for the observed method, it should return <code class="highlighter-rouge">null</code>.</p>

<p>Below is an example of a before method modifying the <code class="highlighter-rouge">$name</code> argument before passing it on to the observed <code class="highlighter-rouge">setName</code> method.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">namespace</span> <span class="nx">My\Module\Plugin</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ProductAttributesUpdater</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">beforeSetName</span><span class="p">(</span><span class="nx">\Magento\Catalog\Model\Product</span> <span class="nv">$subject</span><span class="p">,</span> <span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">'('</span> <span class="o">.</span> <span class="nv">$name</span> <span class="o">.</span> <span class="s1">')'</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h4 id="after-methods">After methods</h4>

<p>Magento runs all after methods following the completion of the observed method. Magento requires these methods have a return value and they must have the same name as the observed method with ‘after’ as the prefix.</p>

<p>You can use these methods to change the result of an observed method by modifying the original result and returning it at the end of the method.</p>

<p>Below is an example of an after method modifying the return value <code class="highlighter-rouge">$result</code> of an observed methods call.</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">namespace</span> <span class="nx">My\Module\Plugin</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ProductAttributesUpdater</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">afterGetName</span><span class="p">(</span><span class="nx">\Magento\Catalog\Model\Product</span> <span class="nv">$subject</span><span class="p">,</span> <span class="nv">$result</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'|'</span> <span class="o">.</span> <span class="nv">$result</span> <span class="o">.</span> <span class="s1">'|'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>After methods have access to all the arguments of their observed methods. When the observed method completes, Magento passes the result and arguments to the next after method that follows. If observed method does not return a result (<code class="highlighter-rouge">@return void</code>), then it passes <code class="highlighter-rouge">null</code> to the next after method.</p>

<p>Below is an example of an after method that accepts the <code class="highlighter-rouge">null</code> result and arguments from the observed <code class="highlighter-rouge">login</code> method for <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Backend/Model/Auth.php" target="_blank"><code class="highlighter-rouge">Magento\Backend\Model\Auth</code></a>:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">namespace</span> <span class="nx">My\Module\Plugin</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AuthLogger</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$logger</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">\Psr\Log\LoggerInterface</span> <span class="nv">$logger</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logger</span> <span class="o">=</span> <span class="nv">$logger</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**
     * @param \Magento\Backend\Model\Auth $authModel
     * @param null $result
     * @param string $username
     * @return void
     * @SuppressWarnings(PHPMD.UnusedFormalParameter)
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">afterLogin</span><span class="p">(</span><span class="nx">\Magento\Backend\Model\Auth</span> <span class="nv">$authModel</span><span class="p">,</span> <span class="nv">$result</span><span class="p">,</span> <span class="nv">$username</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">debug</span><span class="p">(</span><span class="s1">'User '</span> <span class="o">.</span> <span class="nv">$username</span> <span class="o">.</span> <span class="s1">' signed in.'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>After methods do not need to declare all the arguments of their observed methods except those that the method uses and any arguments from the observed method that come before those used arguments.</p>

<p>The following example is a class with an after method for <a href="https://github.com/magento/magento2/blob/2.1/app/code/Magento/Catalog/Model/Product/Action.php" target="_blank"><code class="highlighter-rouge">\Magento\Catalog\Model\Product\Action::updateWebsites($productIds, $websiteIds, $type)</code></a>:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">class</span> <span class="nc">WebsitesLogger</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$logger</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">\Psr\Log\LoggerInterface</span> <span class="nv">$logger</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logger</span> <span class="o">=</span> <span class="nv">$logger</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">afterUpdateWebsites</span><span class="p">(</span><span class="nx">\Magento\Catalog\Model\Product\Action</span> <span class="nv">$subject</span><span class="p">,</span> <span class="nv">$result</span><span class="p">,</span> <span class="nv">$productIds</span><span class="p">,</span> <span class="nv">$websiteIds</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">logger</span><span class="o">-&gt;</span><span class="na">log</span><span class="p">(</span><span class="s1">'Updated websites: '</span> <span class="o">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">', '</span><span class="p">,</span>  <span class="nv">$websiteIds</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>In the example, the <code class="highlighter-rouge">afterUpdateWebsites</code> function uses the variable <code class="highlighter-rouge">$websiteIds</code>, so it declares that variable as an argument. It also declares <code class="highlighter-rouge">$productIds</code> because it comes before <code class="highlighter-rouge">$websiteIds</code> in the parameter signature of the observed method. The after method did not list <code class="highlighter-rouge">$type</code> because it did not use it inside the method nor does it come before <code class="highlighter-rouge">$websiteIds</code>.</p>

<p class="bs-callout bs-callout-warning">If an argument is optional in the observed method, then the after method should also declare it as optional.</p>

<h4 id="around-methods">Around methods</h4>

<p>Magento runs the code in around methods before and after their observed methods. Using these methods allow you to override an observed method. Around methods must have the same name as the observed method with ‘around’ as the prefix.</p>

<div class="bs-callout bs-callout-warning">
  <p>Avoid using around method plugins when they are not required because they increase stack traces and affect performance.
The only use case for around method plugins is when the execution of all further plugins and original methods need termination.
Use after method plugins if you require arguments for replacing or altering function results.</p>
</div>

<p>Before the list of the original method’s arguments, around methods receive a <code class="highlighter-rouge">callable</code> that will allow a call to the next method in the chain. When your code executes the <code class="highlighter-rouge">callable</code>, Magento calls the next plugin or the observed function.</p>

<p class="bs-callout bs-callout-warning">If the around method does not call the <code class="highlighter-rouge">callable</code>, it will prevent the execution of all the plugins next in the chain and the original method call.</p>

<p>Below is an example of an around method adding behavior before and after an observed method:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">namespace</span> <span class="nx">My\Module\Plugin</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ProductAttributesUpdater</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">aroundSave</span><span class="p">(</span><span class="nx">\Magento\Catalog\Model\Product</span> <span class="nv">$subject</span><span class="p">,</span> <span class="nx">callable</span> <span class="nv">$proceed</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$someValue</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">doSmthBeforeProductIsSaved</span><span class="p">();</span>
        <span class="nv">$returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">canCallProceedCallable</span><span class="p">(</span><span class="nv">$someValue</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$returnValue</span> <span class="o">=</span> <span class="nv">$proceed</span><span class="p">();</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nv">$returnValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">postProductToFacebook</span><span class="p">();</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="nv">$returnValue</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>When you wrap a method which accepts arguments, your plugin must also accept those arguments and you must forward them when you invoke the <code>proceed</code> callable. You must be careful to match the default parameters and type hints of the original signature of the method.</p>

<p>For example, the following code defines a parameter of type <code>SomeType</code> which is nullable:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">namespace</span> <span class="nx">My\Module\Model</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyUtility</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">save</span><span class="p">(</span><span class="nx">SomeType</span> <span class="nv">$obj</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">//do something
</span>    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>If you wrapped this method with a plugin like below:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">namespace</span> <span class="nx">My\Module\Plugin</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyUtilityUpdater</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">aroundSave</span><span class="p">(</span><span class="nx">\My\Module\Model\MyUtility</span> <span class="nv">$subject</span><span class="p">,</span> <span class="nx">callable</span> <span class="nv">$proceed</span><span class="p">,</span> <span class="nx">SomeType</span> <span class="nv">$obj</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">//do something
</span>    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Note the missing <code>= null</code>. Now, if Magento calls the original method with <code>null</code>,   <span term-uuid="bf703ab1-ca4b-48f9-b2b7-16a81fd46e02" class="glossary-term" data-toggle="popover">PHP</span>
 would throw a fatal error as your plugin does not accept <code>null</code>.</p>

<p>You are responsible for forwarding the arguments from the plugin to the <code>proceed</code> callable. If you are not using/modifying the arguments, you could use variadics and argument unpacking to achieve this:</p>

<figure class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">namespace</span> <span class="nx">My\Module\Plugin</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyUtilityUpdater</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">aroundSave</span><span class="p">(</span><span class="nx">\My\Module\Model\MyUtility</span> <span class="nv">$subject</span><span class="p">,</span> <span class="nx">callable</span> <span class="nv">$proceed</span><span class="p">,</span> <span class="o">...</span><span class="nv">$args</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">//do something
</span>      <span class="nv">$proceed</span><span class="p">(</span><span class="o">...</span><span class="nv">$args</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="prioritizing-plugins">Prioritizing plugins</h3>

<p>The <code class="highlighter-rouge">sortOrder</code> property for plugins determine when their before, after, or around methods get called when more than one plugins are observing the same method.</p>

<p>The prioritization rules for ordering plugins:</p>

<ul>
  <li>
    <p>Before the execution of the observed method, Magento will execute plugins from lowest to greatest <code class="highlighter-rouge">sortOrder</code>.</p>

    <ul>
      <li>During each plugin execution, Magento executes the current plugin’s before method.</li>
      <li>After the before plugin completes execution, the current plugin’s around method will wrap and execute the next plugin or observed method.</li>
    </ul>
  </li>
  <li>
    <p>Following the execution of the observed method, Magento will execute plugins from greatest to lowest <code class="highlighter-rouge">sortOrder</code>.</p>

    <ul>
      <li>During each plugin execution, the current plugin will first finish executing its around method.</li>
      <li>When the around method completes, the plugin executes its after method before moving on to the next plugin.</li>
    </ul>
  </li>
</ul>

<p><strong>Example</strong></p>

<p>Given the following plugins observing the same method with the following properties:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center">PluginA</th>
      <th style="text-align: center">PluginB</th>
      <th style="text-align: center">PluginC</th>
      <th style="text-align: center">Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><strong>sortOrder</strong></td>
      <td style="text-align: center">10</td>
      <td style="text-align: center">20</td>
      <td style="text-align: center">30</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>before</strong></td>
      <td style="text-align: center">beforeDispatch()</td>
      <td style="text-align: center">beforeDispatch()</td>
      <td style="text-align: center">beforeDispatch()</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>around (first half)</strong></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">aroundDispatch() [first half]</td>
      <td style="text-align: center">aroundDispatch() [first half]</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>original</strong></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">dispatch()</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>around (second half)</strong></td>
      <td style="text-align: center"> </td>
      <td style="text-align: center">aroundDispatch() [second half]</td>
      <td style="text-align: center">aroundDispatch() [second half]</td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>after</strong></td>
      <td style="text-align: center">afterDispatch()</td>
      <td style="text-align: center">afterDispatch()</td>
      <td style="text-align: center">afterDispatch()</td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<p>The execution flow will be as follows:</p>

<ul>
  <li><code class="highlighter-rouge">PluginA::beforeDispatch()</code></li>
  <li><code class="highlighter-rouge">PluginB::beforeDispatch()</code></li>
  <li>
    <p><code class="highlighter-rouge">PluginB::aroundDispatch()</code> (Magento calls the first half until <code class="highlighter-rouge">callable</code>)</p>

    <ul>
      <li><code class="highlighter-rouge">PluginC::beforeDispatch()</code></li>
      <li>
        <p><code class="highlighter-rouge">PluginC::aroundDispatch()</code> (Magento calls the first half until <code class="highlighter-rouge">callable</code>)</p>

        <ul>
          <li><code class="highlighter-rouge">Action::dispatch()</code></li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">PluginC::aroundDispatch()</code> (Magento calls the second half after <code class="highlighter-rouge">callable</code>)</li>
      <li><code class="highlighter-rouge">PluginC::afterDispatch()</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">PluginB::aroundDispatch()</code> (Magento calls the second half after <code class="highlighter-rouge">callable</code>)</li>
  <li><code class="highlighter-rouge">PluginB::afterDispatch()</code></li>
  <li><code class="highlighter-rouge">PluginA::afterDispatch()</code></li>
</ul>

<h3 id="configuration-inheritance">Configuration inheritance</h3>

<p>Classes and interfaces that are implementations of or inherit from classes that have plugins will also inherit plugins from the parent class.</p>

<p>Magento uses plugins defined in the global scope when the system is in a specific area (i.e. frontend, backend, etc). You can also extend or override these global plugin configuration via an area’s <code class="highlighter-rouge">di.xml</code>.</p>

<p>For example, the developer can disable a global plugin in the   <span term-uuid="74d6d228-34bd-4475-a6f8-0c0f4d6d0d61" class="glossary-term" data-toggle="popover">backend</span>
 area by disabling it in the specific <code class="highlighter-rouge">di.xml</code> file for the backend area.</p>

<h3 id="related-topics">Related topics</h3>

<ul>
  <li><a href="/guides/v2.3/extension-dev-guide/depend-inj.html">Dependency injection</a></li>
  <li><a href="/guides/v2.3/extension-dev-guide/events-and-observers.html">Events and observers</a></li>
</ul>

<h3 id="related-information">Related information</h3>

<ul>
  <li><a href="http://vinaikopp.com/2016/03/07/04_the_plugin_integration_test_kata" target="_blank">The Plugin Integration Test Kata</a> by Magento contributor <a href="http://vinaikopp.com/blog/list" target="_blank">Vinai Kopp</a></li>
  <li><a href="http://vinaikopp.com/2016/02/22/03_the_around_interceptor_kata" target="_blank">The Around Interceptor Kata</a> by Magento contributor <a href="http://vinaikopp.com/blog/list" target="_blank">Vinai Kopp</a></li>
</ul>

			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

  


  

    <div class="github-link">
      <a class="improve-page" href="https://github.com/magento/devdocs/blob/master/guides/v2.3/extension-dev-guide/plugins.md" target="_blank">
        Edit this page on GitHub
      </a>
    </div>

    <div class="new-issue">
      <a href="https://github.com/magento/devdocs/issues/new?title=Feedback on page: /guides/v2.3/extension-dev-guide/plugins.html" target="_blank">
        Give us feedback
      </a>
    </div>

  

</div>


	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      <ul class="nav footer-links">
  <li><a href="https://github.com/magento/devdocs/blob/master/.github/CONTRIBUTING.md">Become a Contributor</a>
  <li><a href="https://magento.github.io/glossary/index.html?audience=developer">Glossary</a></li>
  <li><a href="http://magento.com/legal/terms/privacy/">Privacy Policy</a></li>
  <li><a href="http://magento.com/legal/terms/">Terms of Service</a></li>
  <li><a href="http://magento.com/legal/licensing/">License/Trademark FAQ</a></li>
  <li><a href="/guides/v2.3/release-notes/bk-release-notes.html">Release Notes</a></li>
  <li><a href="/magento-third-party.html">Third-Party Licenses</a></li>
</ul>

    </div>

		<div class="copyright-date">&copy; 2018 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/assets/js/app.min.js"></script>





<script type="text/javascript">
    (function() {
        var didInit = false;
        function initMunchkin() {
            if(didInit === false) {
                didInit = true;
                Munchkin.init('585-GGD-959', {cookieAnon: false});
            }
        }
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.async = true;
        s.src = '//munchkin.marketo.net/munchkin.js';
        s.onreadystatechange = function() {
            if (this.readyState == 'complete' || this.readyState == 'loaded') {
                initMunchkin();
            }
        };
        s.onload = initMunchkin;
        document.getElementsByTagName('head')[0].appendChild(s);
    })();
</script>

<script type="text/javascript">_satellite.pageBottom();</script>




</body>
</html>

